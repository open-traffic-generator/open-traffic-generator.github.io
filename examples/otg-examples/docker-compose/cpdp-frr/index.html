
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Ixia-c ARP, BGP and traffic with FRR as a DUT - Open Traffic Generator APIs & Data Models</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-N6X4KDVDJF"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-N6X4KDVDJF",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-N6X4KDVDJF",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ixia-c-arp-bgp-and-traffic-with-frr-as-a-dut" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Open Traffic Generator APIs &amp; Data Models" class="md-header__button md-logo" aria-label="Open Traffic Generator APIs & Data Models" data-md-component="logo">
      
  <img src="../../../../images/otg_icon_white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Open Traffic Generator APIs & Data Models
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Ixia-c ARP, BGP and traffic with FRR as a DUT
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/open-traffic-generator/models" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    open-traffic-generator
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../model/" class="md-tabs__link">
        
  
  
    
  
  Model

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../implementations/" class="md-tabs__link">
        
  
  
    
  
  Implementations

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../clients/" class="md-tabs__link">
          
  
  
  Clients

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../" class="md-tabs__link">
          
  
  
  Examples

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Open Traffic Generator APIs &amp; Data Models" class="md-nav__button md-logo" aria-label="Open Traffic Generator APIs & Data Models" data-md-component="logo">
      
  <img src="../../../../images/otg_icon_white.svg" alt="logo">

    </a>
    Open Traffic Generator APIs & Data Models
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/open-traffic-generator/models" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    open-traffic-generator
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../implementations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Implementations
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Clients
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Clients
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../clients/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../clients/curl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    curl
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../clients/otgen/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    otgen
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../clients/snappi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    snappi
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../clients/gosnappi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    gosnappi
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Basic Configurations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OTG Examples
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Lab configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lab configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Diagram
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#layer-3-topology-and-generated-traffic-flows" class="md-nav__link">
    <span class="md-ellipsis">
      Layer 3 topology and generated traffic flows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#otg" class="md-nav__link">
    <span class="md-ellipsis">
      OTG
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      Quick start
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-components" class="md-nav__link">
    <span class="md-ellipsis">
      Install components
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker-compose-option-to-deploy-the-lab" class="md-nav__link">
    <span class="md-ellipsis">
      Docker Compose option to deploy the lab
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#containerlab-option-to-deploy-the-lab" class="md-nav__link">
    <span class="md-ellipsis">
      Containerlab option to deploy the lab
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-tests-curl-option" class="md-nav__link">
    <span class="md-ellipsis">
      Run tests, curl option
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-tests-otgen-option" class="md-nav__link">
    <span class="md-ellipsis">
      Run tests, otgen option
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#destroy-the-lab" class="md-nav__link">
    <span class="md-ellipsis">
      Destroy the lab
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#credits" class="md-nav__link">
    <span class="md-ellipsis">
      Credits
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="ixia-c-arp-bgp-and-traffic-with-frr-as-a-dut">Ixia-c ARP, BGP and traffic with FRR as a DUT</h1>
<h2 id="overview">Overview</h2>
<p>This lab demonstrates validation of an FRR DUT for basic BGP peering, prefix announcements and passing of traffic between announced subnets. To run OTG protocols and flows, Ixia-c Traffic and Protocol Engine are used.</p>
<p>The same setup can be brought up using one of two methods:</p>
<ul>
<li><a href="https://docs.docker.com/compose/">Docker Compose</a></li>
<li><a href="https://containerlab.dev/">Containerlab</a></li>
</ul>
<p>Also, the same OTG test logic can be executed using one of two OTG clients:</p>
<ul>
<li><a href="https://otg.dev/clients/curl/"><code>curl</code></a></li>
<li><a href="https://otg.dev/clients/otgen/"><code>otgen</code></a></li>
</ul>
<p>Each method has its own benefits. With <code>curl</code>, you can try each individual OTG API call needed to complete the test. On the other hand, <code>otgen</code> demonstrates how all these steps could be easily executed with a single command. By comparing with <code>curl</code> <code>get_metrics</code> or <code>get_state</code> requests output, you can better understands the logic <code>otgen</code> is using to wait for the results of previous API calls to converge or complete. Finally, you can use <a href="https://github.com/open-traffic-generator/otgen/blob/main/cmd/run.go"><code>otgen run</code></a> source code as a starting point for custom test logic you could develop using <a href="https://otg.dev/clients/gosnappi/"><code>gosnappi</code></a> library.</p>
<h2 id="lab-configuration">Lab configuration</h2>
<h3 id="diagram">Diagram</h3>
<p><img alt="Diagram" src="diagram.drawio.svg" /></p>
<h3 id="layer-3-topology-and-generated-traffic-flows">Layer 3 topology and generated traffic flows</h3>
<p><img alt="IP Diagram" src="ip-diagram.drawio.svg" /></p>
<h3 id="otg">OTG</h3>
<p>The lab uses <a href="otg.json"><code>otg.json</code></a> configuration file with the following properties:</p>
<p><img alt="OTG Diagram" src="otg-diagram.drawio.svg" /></p>
<p>To request Ixia-c to use ARP to determine destination MAC address for a flow <code>f1</code>, the following flow properties are used. The <code>dst</code> parameter in the <code>packet</code> section uses <code>auto</code> mode. In addition, <code>tx_rx</code> section has to use names of emulated devices' IP interfaces, as in <code>"tx_names":  ["otg1.eth[0].ipv4[0]"]</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="w">  </span><span class="nt">&quot;flows&quot;</span><span class="p">:</span><span class="w">  </span><span class="p">[</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">      </span><span class="nt">&quot;tx_rx&quot;</span><span class="p">:</span><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">        </span><span class="nt">&quot;choice&quot;</span><span class="p">:</span><span class="w">  </span><span class="s2">&quot;device&quot;</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">        </span><span class="nt">&quot;device&quot;</span><span class="p">:</span><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">          </span><span class="nt">&quot;mode&quot;</span><span class="p">:</span><span class="w">  </span><span class="s2">&quot;mesh&quot;</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">          </span><span class="nt">&quot;tx_names&quot;</span><span class="p">:</span><span class="w">  </span><span class="p">[</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">            </span><span class="s2">&quot;otg1.eth[0].ipv4[0]&quot;</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="w">          </span><span class="p">],</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="w">          </span><span class="nt">&quot;rx_names&quot;</span><span class="p">:</span><span class="w">  </span><span class="p">[</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="w">            </span><span class="s2">&quot;otg2.eth[0].ipv4[0]&quot;</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="w">          </span><span class="p">]</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="w">      </span><span class="p">},</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="w">      </span><span class="nt">&quot;packet&quot;</span><span class="p">:</span><span class="w">  </span><span class="p">[</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="w">        </span><span class="p">{</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="w">          </span><span class="nt">&quot;choice&quot;</span><span class="p">:</span><span class="w">  </span><span class="s2">&quot;ethernet&quot;</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="w">          </span><span class="nt">&quot;ethernet&quot;</span><span class="p">:</span><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="w">            </span><span class="nt">&quot;dst&quot;</span><span class="p">:</span><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="w">              </span><span class="nt">&quot;choice&quot;</span><span class="p">:</span><span class="w">  </span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="w">              </span><span class="nt">&quot;auto&quot;</span><span class="p">:</span><span class="w">  </span><span class="s2">&quot;00:00:00:00:00:00&quot;</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="w">            </span><span class="p">},</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="w">            </span><span class="nt">&quot;src&quot;</span><span class="p">:</span><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="w">              </span><span class="nt">&quot;choice&quot;</span><span class="p">:</span><span class="w">  </span><span class="s2">&quot;value&quot;</span><span class="p">,</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="w">              </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w">  </span><span class="s2">&quot;02:00:00:00:01:aa&quot;</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="w">          </span><span class="p">}</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="w">      </span><span class="p">]</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="w">  </span><span class="p">]</span>
</code></pre></div>
<h2 id="quick-start">Quick start</h2>
<ol>
<li>
<p>Clone this repository</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>git<span class="w"> </span>clone<span class="w"> </span>--recursive<span class="w"> </span>https://github.com/open-traffic-generator/otg-examples.git
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="nb">cd</span><span class="w"> </span>otg-examples/docker-compose/cpdp-frr
</code></pre></div>
</li>
<li>
<p>To run all the steps below at once using Docker Compose, execute:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>make<span class="w"> </span>all
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>make<span class="w"> </span>clean
</code></pre></div>
</li>
<li>
<p>To use Containerlab option, run:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>make<span class="w"> </span>all-clab
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>make<span class="w"> </span>clean
</code></pre></div>
</li>
</ol>
<h2 id="prerequisites">Prerequisites</h2>
<ul>
<li>Linux host or VM with sudo permissions and Docker support</li>
<li><a href="https://docs.docker.com/engine/install/">Docker</a></li>
<li><code>curl</code> command</li>
<li><code>watch</code> command (optional)</li>
<li><code>jq</code> command (optional)</li>
</ul>
<h2 id="install-components">Install components</h2>
<ol>
<li>
<p>Install <code>docker-compose</code> and add yourself to <code>docker</code> group. Logout for group changes to take effect.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>sudo<span class="w"> </span>curl<span class="w"> </span>-L<span class="w"> </span><span class="s2">&quot;https://github.com/docker/compose/releases/download/1.29.2/docker-compose-</span><span class="k">$(</span>uname<span class="w"> </span>-s<span class="k">)</span><span class="s2">-</span><span class="k">$(</span>uname<span class="w"> </span>-m<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span>-o<span class="w"> </span>/usr/local/bin/docker-compose
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>sudo<span class="w"> </span>chmod<span class="w"> </span>+x<span class="w"> </span>/usr/local/bin/docker-compose
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>sudo<span class="w"> </span>usermod<span class="w"> </span>-aG<span class="w"> </span>docker<span class="w"> </span><span class="nv">$USER</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="nb">logout</span>
</code></pre></div>
</li>
<li>
<p>For Containerlab use case, install the latest release. For more installation options see <a href="https://containerlab.dev/install/">here</a>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>bash<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>curl<span class="w"> </span>-sL<span class="w"> </span>https://get.containerlab.dev<span class="k">)</span><span class="s2">&quot;</span>
</code></pre></div>
</li>
<li>
<p>Install <code>otgen</code> tool, version <code>0.6.2</code> or later.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>bash<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>curl<span class="w"> </span>-sL<span class="w"> </span>https://get.otgcdn.net/otgen<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span>--<span class="w"> </span>-v<span class="w"> </span><span class="m">0</span>.6.2
</code></pre></div>
</li>
<li>
<p>Make sure <code>/usr/local/bin</code> is in your <code>$PATH</code> variable (by default this is not the case on CentOS 7)</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="nv">cmd</span><span class="o">=</span>docker-compose
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="nv">dir</span><span class="o">=</span>/usr/local/bin
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="k">if</span><span class="w"> </span>!<span class="w"> </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">cmd</span><span class="si">}</span><span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-x<span class="w"> </span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">cmd</span><span class="si">}</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">cmd</span><span class="si">}</span><span class="s2"> exists in </span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2"> but not in the PATH, updating PATH to:&quot;</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">  </span><span class="nv">PATH</span><span class="o">=</span><span class="s2">&quot;/usr/local/bin:</span><span class="si">${</span><span class="nv">PATH</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$PATH</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="k">fi</span>
</code></pre></div>
</li>
<li>
<p>Clone this repository</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>git<span class="w"> </span>clone<span class="w"> </span>--recursive<span class="w"> </span>https://github.com/open-traffic-generator/otg-examples.git
</code></pre></div>
</li>
</ol>
<h2 id="docker-compose-option-to-deploy-the-lab">Docker Compose option to deploy the lab</h2>
<ol>
<li>
<p>Launch the deployment using Docker Compose</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="nb">cd</span><span class="w"> </span>otg-examples/docker-compose/cpdp-frr
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>docker-compose<span class="w"> </span>up<span class="w"> </span>-d
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>sudo<span class="w"> </span>docker<span class="w"> </span>ps
</code></pre></div>
</li>
<li>
<p>Make sure you have all five containers running. The result should look like this</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>CONTAINER<span class="w"> </span>ID<span class="w">   </span>IMAGE<span class="w">                                                              </span>COMMAND<span class="w">                  </span>CREATED<span class="w">         </span>STATUS<span class="w">         </span>PORTS<span class="w">                                                                                      </span>NAMES
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>0ea1e56720ac<span class="w">   </span>ghcr.io/open-traffic-generator/ixia-c-protocol-engine:1.00.0.337<span class="w">   </span><span class="s2">&quot;/docker_im/opt/Ixia…&quot;</span><span class="w">   </span><span class="m">3</span><span class="w"> </span>seconds<span class="w"> </span>ago<span class="w">   </span>Up<span class="w"> </span><span class="m">3</span><span class="w"> </span>seconds<span class="w">                                                                                              </span>cpdp-frr_protocol_engine_1_1
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>44f4c9fb8b3e<span class="w">   </span>ghcr.io/open-traffic-generator/ixia-c-protocol-engine:1.00.0.337<span class="w">   </span><span class="s2">&quot;/docker_im/opt/Ixia…&quot;</span><span class="w">   </span><span class="m">3</span><span class="w"> </span>seconds<span class="w"> </span>ago<span class="w">   </span>Up<span class="w"> </span><span class="m">3</span><span class="w"> </span>seconds<span class="w">                                                                                              </span>cpdp-frr_protocol_engine_2_1
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>6e50d4cad6a6<span class="w">   </span>ghcr.io/open-traffic-generator/keng-controller:0.1.0-3<span class="w">             </span><span class="s2">&quot;./bin/controller --…&quot;</span><span class="w">   </span><span class="m">4</span><span class="w"> </span>seconds<span class="w"> </span>ago<span class="w">   </span>Up<span class="w"> </span><span class="m">4</span><span class="w"> </span>seconds<span class="w">                                                                                              </span>cpdp-frr_controller_1
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>7fe400f12196<span class="w">   </span>quay.io/frrouting/frr:8.4.2<span class="w">                                        </span><span class="s2">&quot;/sbin/tini -- /usr/…&quot;</span><span class="w">   </span><span class="m">4</span><span class="w"> </span>seconds<span class="w"> </span>ago<span class="w">   </span>Up<span class="w"> </span><span class="m">3</span><span class="w"> </span>seconds<span class="w">                                                                                              </span>cpdp-frr_frr_1
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>2a7e1c124cbd<span class="w">   </span>ghcr.io/open-traffic-generator/ixia-c-traffic-engine:1.6.0.85<span class="w">      </span><span class="s2">&quot;./entrypoint.sh&quot;</span><span class="w">        </span><span class="m">4</span><span class="w"> </span>seconds<span class="w"> </span>ago<span class="w">   </span>Up<span class="w"> </span><span class="m">3</span><span class="w"> </span>seconds<span class="w">   </span><span class="m">0</span>.0.0.0:5556-&gt;5556/tcp,<span class="w"> </span>:::5556-&gt;5556/tcp,<span class="w"> </span><span class="m">0</span>.0.0.0:50072-&gt;50071/tcp,<span class="w"> </span>:::50072-&gt;50071/tcp<span class="w">   </span>cpdp-frr_traffic_engine_2_1
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>cbc0a64278cc<span class="w">   </span>ghcr.io/open-traffic-generator/ixia-c-traffic-engine:1.6.0.85<span class="w">      </span><span class="s2">&quot;./entrypoint.sh&quot;</span><span class="w">        </span><span class="m">4</span><span class="w"> </span>seconds<span class="w"> </span>ago<span class="w">   </span>Up<span class="w"> </span><span class="m">3</span><span class="w"> </span>seconds<span class="w">   </span><span class="m">0</span>.0.0.0:5555-&gt;5555/tcp,<span class="w"> </span>:::5555-&gt;5555/tcp,<span class="w"> </span><span class="m">0</span>.0.0.0:50071-&gt;50071/tcp,<span class="w"> </span>:::50071-&gt;50071/tcp<span class="w">   </span>cpdp-frr_traffic_engine_1_1
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>p
</code></pre></div>
</li>
<li>
<p>Interconnect traffic engine containers via a veth pair</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>sudo<span class="w"> </span>../../utils/connect_containers_veth.sh<span class="w"> </span>cpdp-frr_traffic_engine_1_1<span class="w"> </span>cpdp-frr_frr_1<span class="w"> </span>veth0<span class="w"> </span>veth1
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>sudo<span class="w"> </span>../../utils/connect_containers_veth.sh<span class="w"> </span>cpdp-frr_traffic_engine_2_1<span class="w"> </span>cpdp-frr_frr_1<span class="w"> </span>veth2<span class="w"> </span>veth3
</code></pre></div>
</li>
<li>
<p>Check traffic and protocol engine logs to see if they picked up veth interfaces</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>sudo<span class="w"> </span>docker<span class="w"> </span>logs<span class="w"> </span>cpdp-frr_traffic_engine_1_1
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>sudo<span class="w"> </span>docker<span class="w"> </span>logs<span class="w"> </span>cpdp-frr_traffic_engine_2_1
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>sudo<span class="w"> </span>docker<span class="w"> </span>logs<span class="w"> </span>cpdp-frr_protocol_engine_1_1
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>sudo<span class="w"> </span>docker<span class="w"> </span>logs<span class="w"> </span>cpdp-frr_protocol_engine_2_1
</code></pre></div>
</li>
</ol>
<h2 id="containerlab-option-to-deploy-the-lab">Containerlab option to deploy the lab</h2>
<ol>
<li>
<p>Launch the deployment using Containerlab</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="nb">cd</span><span class="w"> </span>otg-examples/docker-compose/cpdp-frr
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>sudo<span class="w"> </span>-E<span class="w"> </span>containerlab<span class="w"> </span>deploy
</code></pre></div>
</li>
</ol>
<h2 id="run-tests-curl-option">Run tests, <code>curl</code> option</h2>
<ol>
<li>
<p>Apply config</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="nv">OTG_HOST</span><span class="o">=</span><span class="s2">&quot;https://localhost:8443&quot;</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>curl<span class="w"> </span>-k<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">OTG_HOST</span><span class="si">}</span><span class="s2">/config&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">    </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w">    </span>-d<span class="w"> </span>@otg.json
</code></pre></div>
</li>
<li>
<p>Start protocols</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>curl<span class="w"> </span>-k<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">OTG_HOST</span><span class="si">}</span><span class="s2">/control/state&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="w">    </span>-H<span class="w">  </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">    </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;choice&quot;: &quot;protocol&quot;,&quot;protocol&quot;: {&quot;choice&quot;: &quot;all&quot;,&quot;all&quot;: {&quot;state&quot;: &quot;start&quot;}}}&#39;</span>
</code></pre></div>
</li>
<li>
<p>Fetch ARP table</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>curl<span class="w"> </span>-sk<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">OTG_HOST</span><span class="si">}</span><span class="s2">/monitor/states&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="w">    </span>-X<span class="w"> </span>POST<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="w">    </span>-H<span class="w">  </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="w">    </span>-d<span class="w"> </span><span class="s1">&#39;{ &quot;choice&quot;: &quot;ipv4_neighbors&quot; }&#39;</span>
</code></pre></div>
</li>
<li>
<p>Fetch BGP metrics (stop with <code>Ctrl-c</code>)</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>watch<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="s2">&quot;curl -sk \&quot;</span><span class="si">${</span><span class="nv">OTG_HOST</span><span class="si">}</span><span class="s2">/monitor/metrics\&quot; \</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="s2">    -X POST \</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="s2">    -H  &#39;Content-Type: application/json&#39; \</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="s2">    -d &#39;{ \&quot;choice\&quot;: \&quot;bgpv4\&quot; }&#39;&quot;</span>
</code></pre></div>
</li>
<li>
<p>Fetch BGP prefix announcements - TODO this doesn't show the actual announcements</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>curl<span class="w"> </span>-sk<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">OTG_HOST</span><span class="si">}</span><span class="s2">/monitor/states&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="w">    </span>-X<span class="w"> </span>POST<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="w">    </span>-H<span class="w">  </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="w">    </span>-d<span class="w"> </span><span class="s1">&#39;{ &quot;choice&quot;: &quot;bgp_prefixes&quot; }&#39;</span>
</code></pre></div>
</li>
<li>
<p>Start transmitting flows</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>curl<span class="w"> </span>-sk<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">OTG_HOST</span><span class="si">}</span><span class="s2">/control/state&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="w">    </span>-H<span class="w">  </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="w">    </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;choice&quot;: &quot;traffic&quot;, &quot;traffic&quot;: {&quot;choice&quot;: &quot;flow_transmit&quot;, &quot;flow_transmit&quot;: {&quot;state&quot;: &quot;start&quot;}}}&#39;</span>
</code></pre></div>
</li>
<li>
<p>Fetch flow metrics (stop with <code>Ctrl-c</code>)</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>watch<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="s2">&quot;curl -sk \&quot;</span><span class="si">${</span><span class="nv">OTG_HOST</span><span class="si">}</span><span class="s2">/monitor/metrics\&quot; \</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="s2">    -X POST \</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="s2">    -H  &#39;Content-Type: application/json&#39; \</span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="s2">    -d &#39;{ \&quot;choice\&quot;: \&quot;flow\&quot; }&#39;&quot;</span>
</code></pre></div>
</li>
<li>
<p>Fetch port metrics</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>curl<span class="w"> </span>-sk<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">OTG_HOST</span><span class="si">}</span><span class="s2">/monitor/metrics&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="w">    </span>-X<span class="w"> </span>POST<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="w">    </span>-H<span class="w">  </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="w">    </span>-d<span class="w"> </span><span class="s1">&#39;{ &quot;choice&quot;: &quot;port&quot; }&#39;</span>
</code></pre></div>
</li>
</ol>
<h2 id="run-tests-otgen-option">Run tests, <code>otgen</code> option</h2>
<ol>
<li>
<p>Use one <code>otgen run</code> command to repeat all of the steps above. Note <code>--rxbgp 2x</code> parameter. We use it to tell <code>otgen</code> it should wait, after starting the protocols, until twice as many routes were received from the DUT, than were advertised by KENG. For our lab configuration it would be the signal that BGP protocol has converged. In other setups this parameter might be different.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">OTG_API</span><span class="o">=</span><span class="s2">&quot;https://localhost:8443&quot;</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>otgen<span class="w"> </span>--log<span class="w"> </span>info<span class="w"> </span>run<span class="w"> </span>--insecure<span class="w"> </span>--file<span class="w"> </span>otg.json<span class="w"> </span>--json<span class="w"> </span>--rxbgp<span class="w"> </span>2x<span class="w"> </span>--metrics<span class="w"> </span>flow<span class="w"> </span><span class="p">|</span><span class="w"> </span>jq
</code></pre></div>
</li>
<li>
<p>To format output as a table, use the modified command below. Note, there will be no log output in this case, so be patient to wait for the table output to appear.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>otgen<span class="w"> </span>run<span class="w"> </span>--insecure<span class="w"> </span>--file<span class="w"> </span>otg.json<span class="w"> </span>--json<span class="w"> </span>--rxbgp<span class="w"> </span>2x<span class="w"> </span>--metrics<span class="w"> </span>flow<span class="w"> </span><span class="p">|</span><span class="w"> </span>otgen<span class="w"> </span>transform<span class="w"> </span>--metrics<span class="w"> </span>flow<span class="w"> </span><span class="p">|</span><span class="w"> </span>otgen<span class="w"> </span>display<span class="w"> </span>--mode<span class="w"> </span>table
</code></pre></div>
</li>
</ol>
<h2 id="destroy-the-lab">Destroy the lab</h2>
<ul>
<li>
<p>To destroy the lab brought up via Docker Compose, including veth pairs, use:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>docker-compose<span class="w"> </span>down
</code></pre></div>
</li>
<li>
<p>To destroy the lab brought up via Containerlab, use:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>sudo<span class="w"> </span>containerlab<span class="w"> </span>destroy<span class="w"> </span>-c
</code></pre></div>
</li>
</ul>
<h2 id="credits">Credits</h2>
<ul>
<li><code>connect_containers_veth.sh</code> copyright of <a href="https://github.com/cslev/add_veth_to_docker/">Levente Csikor</a>, with modifications to replace <code>ifconfig</code> with <code>ip link</code>.</li>
</ul>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/open-traffic-generator" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://ixia-c.slack.com" target="_blank" rel="noopener" title="ixia-c.slack.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M94.1 315.1c0 25.9-21.2 47.1-47.1 47.1S0 341 0 315.1 21.2 268 47.1 268h47.1v47.1zm23.7 0c0-25.9 21.2-47.1 47.1-47.1s47.1 21.2 47.1 47.1v117.8c0 25.9-21.2 47.1-47.1 47.1s-47.1-21.2-47.1-47.1zm47.1-189c-25.9 0-47.1-21.2-47.1-47.1s21.2-47 47.1-47S212 53.2 212 79.1v47.1h-47.1zm0 23.7c25.9 0 47.1 21.2 47.1 47.1S190.8 244 164.9 244H47.1C21.2 244 0 222.8 0 196.9s21.2-47.1 47.1-47.1zm189 47.1c0-25.9 21.2-47.1 47.1-47.1s47 21.2 47 47.1-21.2 47.1-47.1 47.1h-47.1v-47.1zm-23.7 0c0 25.9-21.2 47.1-47.1 47.1S236 222.8 236 196.9V79.1c0-25.9 21.2-47.1 47.1-47.1s47.1 21.2 47.1 47.1zm-47.1 189c25.9 0 47.1 21.2 47.1 47.1s-21.2 47-47.1 47-47.1-21.2-47.1-47.1v-47.1h47.1zm0-23.7c-25.9 0-47.1-21.2-47.1-47.1s21.2-47.1 47.1-47.1h117.8c25.9 0 47.1 21.2 47.1 47.1s-21.2 47.1-47.1 47.1z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.instant", "navigation.tracking", "navigation.top"], "search": "../../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.50899def.min.js"></script>
      
    
  </body>
</html>